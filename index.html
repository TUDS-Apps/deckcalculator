<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Deck Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="deckcalculatorstyles.css" />
    <script src="deckCalcjs/app.js" type="module"></script>
  </head>
  <body class="bg-gray-100 p-4 md:p-8">
    <div class="container mx-auto max-w-7xl">
      <h1 class="text-2xl md:text-3xl font-bold mb-6 text-[#1A2B49]">
        Deck Calculator
      </h1>

      <div id="main-layout-container" class="flex flex-col lg:flex-row gap-8">
        <div id="input-panel" class="lg:w-1/4">
          <div class="info-card">
            <h2 class="text-xl font-semibold mb-4 text-[#333333]">
              Specifications
            </h2>
            <form id="deckSpecsForm" class="space-y-4">
              <div>
                <label class="form-label">Deck Height (Floor to Ground)</label>
                <div class="flex gap-2 mt-1">
                  <div class="flex-1">
                    <select
                      id="deckHeightFeet"
                      name="deckHeightFeet"
                      class="form-select"
                    >
                      <option value="1">1'</option>
                      <option value="2">2'</option>
                      <option value="3">3'</option>
                      <option value="4" selected>4'</option>
                      <option value="5">5'</option>
                      <option value="6">6'</option>
                      <option value="7">7'</option>
                      <option value="8">8'</option>
                      <option value="9">9'</option>
                      <option value="10">10'</option>
                      <option value="11">11'</option>
                      <option value="12">12'</option>
                    </select>
                  </div>
                  <div class="flex-1">
                    <select
                      id="deckHeightInchesInput"
                      name="deckHeightInchesInput"
                      class="form-select"
                    >
                      <option value="0" selected>0"</option>
                      <option value="1">1"</option>
                      <option value="2">2"</option>
                      <option value="3">3"</option>
                      <option value="4">4"</option>
                      <option value="5">5"</option>
                      <option value="6">6"</option>
                      <option value="7">7"</option>
                      <option value="8">8"</option>
                      <option value="9">9"</option>
                      <option value="10">10"</option>
                      <option value="11">11"</option>
                    </select>
                  </div>
                </div>
              </div>
              <div>
                <label for="footingType" class="form-label">Footing Type</label>
                <select id="footingType" name="footingType" class="form-select">
                  <option value="gh_levellers">
                    GH Levellers + 16x16 Slab
                  </option>
                  <option value="pylex">Pylex 50" Screw Piles</option>
                  <option value="helical">10' Helical Piles</option>
                </select>
              </div>
              <div>
                <label for="joistSpacing" class="form-label"
                  >Joist Spacing (On Center)</label
                >
                <select
                  id="joistSpacing"
                  name="joistSpacing"
                  class="form-select"
                >
                  <option value="16">16" OC</option>
                  <option value="12">12" OC</option>
                </select>
              </div>
              <div>
                <label for="attachmentType" class="form-label"
                  >Attachment Type</label
                >
                <select
                  id="attachmentType"
                  name="attachmentType"
                  class="form-select"
                >
                  <option value="house_rim">House Rim (Ledger)</option>
                  <option value="concrete">Concrete Foundation</option>
                  <option value="floating">Floating</option>
                </select>
              </div>
              <div>
                <label for="beamType" class="form-label">Beam Type</label>
                <select id="beamType" name="beamType" class="form-select">
                  <option value="drop">Drop Beam</option>
                  <option value="flush">Flush Beam</option>
                </select>
              </div>
              <div>
                <label for="pictureFrame" class="form-label"
                  >Picture Frame</label
                >
                <select
                  id="pictureFrame"
                  name="pictureFrame"
                  class="form-select"
                >
                  <option value="none">None</option>
                  <option value="single">Single</option>
                  <option value="double">Double</option>
                </select>
              </div>
              <div>
                <label for="joistProtection" class="form-label"
                  >Joist Protection</label
                >
                <select
                  id="joistProtection"
                  name="joistProtection"
                  class="form-select"
                >
                  <option value="none" selected>None</option>
                  <option value="gtape">G-Tape</option>
                  <option value="coating">Deck Coating</option>
                </select>
              </div>
              <div>
                <label for="fasteners" class="form-label"
                  >Framing Fasteners</label
                >
                <select id="fasteners" name="fasteners" class="form-select">
                  <option value="screws_3in">3" Deck Screws</option>
                  <option value="u2_3_18">U2 3-1/8"</option>
                  <option value="paslode_3_14">Paslode 3-1/4"</option>
                </select>
              </div>
            </form>

            <div
              id="stairsInputSection"
              class="mt-6 border-t border-gray-200 pt-4 space-y-4 hidden"
            >
              <h3 class="text-lg font-semibold text-[#333333]">
                Stair Details
              </h3>
              <div>
                <label for="stairWidth" class="form-label">Width</label>
                <select id="stairWidth" name="stairWidth" class="form-select">
                  <option value="4">4' 0"</option>
                  <option value="5">5' 0"</option>
                  <option value="6">6' 0"</option>
                  <option value="7">7' 0"</option>
                  <option value="8">8' 0"</option>
                  <option value="9">9' 0"</option>
                  <option value="10">10' 0"</option>
                  <option value="11">11' 0"</option>
                  <option value="12">12' 0"</option>
                  <option value="13">13' 0"</option>
                  <option value="14">14' 0"</option>
                  <option value="15">15' 0"</option>
                  <option value="16">16' 0"</option>
                  <option value="17">17' 0"</option>
                  <option value="18">18' 0"</option>
                  <option value="19">19' 0"</option>
                  <option value="20">20' 0"</option>
                </select>
              </div>
              <div>
                <label for="stringerType" class="form-label"
                  >Stringer Type</label
                >
                <select
                  id="stringerType"
                  name="stringerType"
                  class="form-select"
                >
                  <option value="pylex_steel">Pylex Steel (Pre-fab)</option>
                  <option value="lvl_wood">LVL Wood (Pre-fab)</option>
                  <option value="custom_2x12">Custom Cut 2x12</option>
                </select>
              </div>
              <div>
                <label for="landingType" class="form-label">Landing Type</label>
                <select id="landingType" name="landingType" class="form-select">
                  <option value="existing">
                    Existing Surface (Ground/Patio)
                  </option>
                  <option value="slabs_16x16">16"x16" Slabs</option>
                  <option value="concrete_pad">Poured Concrete Pad</option>
                </select>
              </div>
              <div class="pt-2">
                <button
                  type="button"
                  id="cancelStairsBtn"
                  class="btn btn-secondary btn-full-width"
                >
                  Cancel Adding Stairs
                </button>
              </div>
              <p class="text-sm text-gray-600">
                Select options above, then click a deck edge (rim joist) to
                place the stairs.
              </p>
            </div>

            <div class="button-container mt-6">
              <button
                type="button"
                id="generatePlanBtn"
                class="btn btn-primary btn-full-width"
              >
                Generate Plan
              </button>
              <button
                type="button"
                id="addStairsBtn"
                class="btn btn-secondary btn-full-width"
              >
                Add Stairs
              </button>
            </div>

            <div
              id="summarySection"
              class="mt-6 border-t border-gray-200 pt-4 hidden"
            >
              <h3 class="text-lg font-semibold mb-2 text-[#333333]">
                Project Summary
              </h3>
              <dl id="summaryList" class="summary-list text-sm"></dl>
            </div>
          </div>
        </div>

        <div id="main-content-panel" class="lg:w-3/4 flex flex-col gap-8">
          <div
            id="canvasContainerWrapper"
            class="bg-white p-4 rounded-lg shadow relative"
          >
            <div
              id="legend"
              class="mb-2 p-2 border border-gray-200 rounded bg-gray-50 text-sm"
            >
              <div class="flex justify-between items-center mb-1">
                <h3 class="font-semibold">Legend:</h3>
                <div id="blueprintLegend" class="text-xs text-gray-700 hidden">
                  <span class="px-1 py-0.5 bg-blue-100 rounded">Blueprint view: Components shown to scale</span>
                </div>
              </div>
              <div class="flex flex-wrap gap-x-4 gap-y-1">
                <span class="legend-item"
                  ><span class="legend-icon bg-[#4A90E2]"></span> Deck
                  Outline</span
                >
                <span class="legend-item"
                  ><span class="legend-icon bg-orange-500"></span> Ledger</span
                >
                <span class="legend-item"
                  ><span class="legend-icon bg-gray-700"></span> Joist/Rim</span
                >
                <span class="legend-item"
                  ><span class="legend-icon bg-red-600 font-bold"></span>
                  Beam</span
                >
                <span class="legend-item"
                  ><span class="legend-icon legend-icon-post"></span> Post/Footing</span
                >
                <span class="legend-item"
                  ><span
                    class="legend-icon legend-icon-blocking bg-[#8B5CF6]"
                  ></span>
                  Blocking</span
                >
              </div>
              <div id="dimensionsLegend" class="text-xs text-gray-600 mt-1 hidden">
                <ul class="ml-4 list-disc">
                  <li>Joists/Rim Joists: 1½" thick (actual 2x lumber thickness)</li>
                  <li>Beams: Multiple 1½" boards side by side</li>
                  <li>Posts: Actual 3½" (4x4) or 5½" (6x6) dimensions</li>
                </ul>
              </div>
            </div>

            <!-- Progress Stepper -->
            <div id="progressStepper" class="progress-stepper mb-4">
              <div class="progress-step" data-step="1">
                <div class="step-circle">1</div>
                <div class="step-label">Draw Outline</div>
              </div>
              <div class="progress-connector"></div>
              <div class="progress-step" data-step="2">
                <div class="step-circle">2</div>
                <div class="step-label">Select Wall</div>
              </div>
              <div class="progress-connector"></div>
              <div class="progress-step" data-step="3">
                <div class="step-circle">3</div>
                <div class="step-label">Generate Plan</div>
              </div>
              <div class="progress-connector"></div>
              <div class="progress-step optional" data-step="4">
                <div class="step-circle">4</div>
                <div class="step-label">Add Stairs</div>
                <div class="optional-badge">Optional</div>
              </div>
            </div>

            <div class="flex justify-between items-center mb-2">
              <p id="canvasStatus" class="text-sm text-gray-600 flex-grow mr-2">
                Draw your deck outline. Click near the start point to close the
                shape.
              </p>
              <div class="flex items-center space-x-2 flex-shrink-0">
                <button
                  type="button"
                  id="zoomInBtn"
                  class="btn btn-secondary text-xs px-3 py-1 leading-tight"
                  title="Zoom In"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 20 20"
                    fill="currentColor"
                    class="w-4 h-4"
                  >
                    <path
                      d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"
                    />
                  </svg>
                </button>
                <button
                  type="button"
                  id="zoomOutBtn"
                  class="btn btn-secondary text-xs px-3 py-1 leading-tight"
                  title="Zoom Out"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 20 20"
                    fill="currentColor"
                    class="w-4 h-4"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M4 10a.75.75 0 0 1 .75-.75h10.5a.75.75 0 0 1 0 1.5H4.75A.75.75 0 0 1 4 10Z"
                      clip-rule="evenodd"
                    />
                  </svg>
                </button>
                <button
                  type="button"
                  id="centerFitBtn"
                  class="btn btn-secondary text-xs px-3 py-1 leading-tight"
                  title="Center and Fit Drawing"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 20 20"
                    fill="currentColor"
                    class="w-4 h-4 inline-block mr-0.5"
                  >
                    <path
                      d="M10 3.75a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5a.75.75 0 0 1 .75-.75ZM10 13.75a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5a.75.75 0 0 1 .75-.75ZM6.25 10a.75.75 0 0 0-1.5 0v6.25a.75.75 0 0 0 1.5 0V10Zm7.5 0a.75.75 0 0 0-1.5 0v6.25a.75.75 0 0 0 1.5 0V10ZM3.75 10a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 0 1.5h-1.5a.75.75 0 0 1-.75-.75ZM13.75 10a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 0 1.5h-1.5a.75.75 0 0 1-.75-.75Z"
                    />
                    <path
                      fill-rule="evenodd"
                      d="M4 4a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H4Zm0-1.5A3.5 3.5 0 0 0 .5 6v8A3.5 3.5 0 0 0 4 17.5h12A3.5 3.5 0 0 0 19.5 14V6A3.5 3.5 0 0 0 16 2.5H4Z"
                      clip-rule="evenodd"
                    /></svg
                  >Fit
                </button>
                <button
                  id="blueprintToggleBtn"
                  class="btn btn-secondary text-xs px-3 py-1 leading-tight flex-shrink-0"
                  title="Toggle Blueprint View"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4 inline-block mr-0.5">
                    <path d="M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z" />
                    <path fill-rule="evenodd" d="M.664 10.59a1.651 1.651 0 010-1.186A10.004 10.004 0 0110 3c4.257 0 7.893 2.66 9.336 6.41.147.381.146.804 0 1.186A10.004 10.004 0 0110 17c-4.257 0-7.893-2.66-9.336-6.41zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd" />
                  </svg>
                  Blueprint
                </button>
                <button
                  id="clearCanvasBtn"
                  class="btn btn-secondary text-xs px-3 py-1 leading-tight flex-shrink-0"
                >
                  Clear
                </button>
              </div>
            </div>
            <div id="dimensionInputContainer" class="flex items-center mb-2 hidden">
              <label class="text-sm text-gray-600 mr-2">Enter length:</label>
              <div class="flex flex-1 gap-2">
                <input id="dimensionFeetInput" type="number" min="0" class="form-input text-sm py-1 px-2 w-16" placeholder="ft">
                <input id="dimensionInchesInput" type="number" min="0" max="11" class="form-input text-sm py-1 px-2 w-16" placeholder="in">
              </div>
              <button id="applyDimensionBtn" class="btn btn-secondary text-xs px-3 py-1 leading-tight ml-2">Apply</button>
              <button id="cancelDimensionBtn" class="btn btn-secondary text-xs px-3 py-1 leading-tight ml-2">Cancel</button>
            </div>
            <div id="canvasContainer">
              <canvas id="deckCanvas"></canvas>
            </div>
          </div>

          <div id="bomSection" class="info-card hidden">
            <div class="flex justify-between items-center mb-4">
              <h2 class="text-xl font-semibold text-[#333333]">
                Materials List
              </h2>
              <button
                type="button"
                id="printBomBtn"
                class="btn btn-secondary px-3 py-1 text-sm"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                  class="w-4 h-4 inline-block mr-1 align-text-bottom"
                >
                  <path
                    fill-rule="evenodd"
                    d="M5 2.75C5 1.784 5.784 1 6.75 1h6.5c.966 0 1.75.784 1.75 1.75v3.552c.377.046.752.11 1.126.192.484.107.912.284 1.234.534a.75.75 0 0 1 0 1.244c-.322.25-.75.427-1.234.534a11.46 11.46 0 0 1-1.126.192v3.552c0 .966-.784 1.75-1.75 1.75h-6.5A1.75 1.75 0 0 1 5 14.25v-3.552a11.46 11.46 0 0 1-1.126-.192c-.484-.107-.912-.284-1.234-.534a.75.75 0 0 1 0-1.244c.322-.25.75-.427 1.234-.534A11.46 11.46 0 0 1 5 8.25V2.75Zm2.25 9.5a.75.75 0 0 0 .75.75h4a.75.75 0 0 0 .75-.75V8.75a.75.75 0 0 0-.75-.75h-4a.75.75 0 0 0-.75.75v3.5ZM5.28 3.22a.22.22 0 0 0-.221.28l.004.004a.753.753 0 0 0 .217.276V7.1a.75.75 0 0 0 .75.75h8.5a.75.75 0 0 0 .75-.75V3.78a.753.753 0 0 0 .217-.276l.004-.004a.22.22 0 0 0-.221-.28H5.28ZM3.5 7.875c0 .414.336.75.75.75h11.5a.75.75 0 0 0 .75-.75V4.125a.75.75 0 0 0-.75-.75H4.25a.75.75 0 0 0-.75.75v3.75Z"
                    clip-rule="evenodd"
                  />
                </svg>
                Print
              </button>
            </div>
            <div class="overflow-x-auto">
              <table class="w-full bom-table">
                <thead>
                  <tr>
                    <th class="qty-col">Qty</th>
                    <th>Item</th>
                    <th>Description</th>
                    <th class="price-col">Unit Price</th>
                    <th class="price-col">Total Price</th>
                  </tr>
                </thead>
                <tbody id="bomTableBody"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
